<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>FinanceFlowCFO – Login</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
    rel="stylesheet"
  />
  <style>
    :root {
      --deep-indigo: #4C1D95;
      --royal-purple: #7C3AED;
      --soft-lavender: #A78BFA;
      --light-periwinkle: #E0E7FF;
      --charcoal: #374151;
      --slate-gray: #64748B;
      --success-green: #10B981;
      --warning-amber: #F59E0B;
      --error-red: #EF4444;
    }

    body {
      font-family: "Inter", sans-serif;
      background: linear-gradient(135deg, var(--light-periwinkle) 0%, #ffffff 100%);
      min-height: 100vh;
    }

    .glass-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(124, 58, 237, 0.1);
      box-shadow: 0 20px 40px rgba(76, 29, 149, 0.15);
    }

    .gradient-text {
      background: linear-gradient(135deg, var(--deep-indigo), var(--royal-purple));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--royal-purple), var(--soft-lavender));
      transition: all 0.3s ease;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 15px -3px rgba(124, 58, 237, 0.3);
    }

    .floating-element {
      animation: float 6s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(5deg); }
    }

    .reveal {
      opacity: 0;
      transform: translateY(30px);
    }

    .reveal.active {
      opacity: 1;
      transform: translateY(0);
      transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center px-4 py-12 relative overflow-hidden">
  <!-- Decorative floating elements -->
  <div class="absolute inset-0 overflow-hidden pointer-events-none">
    <div class="absolute top-20 left-20 w-32 h-32 bg-purple-200 rounded-full opacity-20 floating-element" style="animation-delay: 0s;"></div>
    <div class="absolute top-40 right-32 w-24 h-24 bg-purple-300 rounded-full opacity-30 floating-element" style="animation-delay: 2s;"></div>
    <div class="absolute bottom-32 left-1/4 w-40 h-40 bg-purple-100 rounded-full opacity-25 floating-element" style="animation-delay: 4s;"></div>
    <div class="absolute bottom-20 right-20 w-28 h-28 bg-purple-200 rounded-full opacity-20 floating-element" style="animation-delay: 3s;"></div>
  </div>

  <div class="max-w-md w-full glass-card rounded-2xl p-8 reveal relative z-10">
    <!-- Logo/Brand -->
    <div class="text-center mb-8">
      <div class="w-20 h-20 mx-auto mb-4 bg-gradient-to-br from-purple-500 to-purple-700 rounded-2xl flex items-center justify-center shadow-lg">
        <svg class="w-10 h-10 text-white" fill="currentColor" viewBox="0 0 20 20">
          <path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"></path>
        </svg>
      </div>
      <h1 class="text-3xl font-bold gradient-text mb-2">
        FinanceFlowCFO
      </h1>
      <p id="modeTitle" class="text-gray-600">
        Sign in to your account
      </p>
    </div>

    <form id="authForm" class="space-y-4">
      <div>
        <label for="email" class="block text-sm font-semibold text-gray-700 mb-2">
          Email Address
        </label>
        <input
          id="email"
          type="email"
          required
          class="w-full px-4 py-3 bg-white border border-purple-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-200"
          placeholder="you@example.com"
        />
      </div>

      <div>
        <label for="password" class="block text-sm font-semibold text-gray-700 mb-2">
          Password
        </label>
        <input
          id="password"
          type="password"
          required
          minlength="6"
          class="w-full px-4 py-3 bg-white border border-purple-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-200"
          placeholder="••••••••"
        />
      </div>

      <p id="errorBox" class="text-sm text-red-600 min-h-[1.25rem]"></p>

      <button
        id="submitBtn"
        type="submit"
        class="btn-primary w-full py-3 rounded-xl font-semibold text-white disabled:opacity-60 disabled:cursor-not-allowed"
      >
        Sign in
      </button>
    </form>

    <p class="mt-6 text-center text-sm text-gray-600">
      <span id="toggleText">Don't have an account?</span>
      <button
        id="toggleModeBtn"
        type="button"
        class="ml-1 text-purple-600 font-semibold hover:underline"
      >
        Create one
      </button>
    </p>

    <p class="mt-4 text-center text-xs text-gray-400">
      You can change plans any time from inside FinanceFlowCFO.
    </p>
  </div>

  <script>
    const API_BASE = "https://financeflow-api-4mua.onrender.com";

    const form = document.getElementById("authForm");
    const emailInput = document.getElementById("email");
    const passwordInput = document.getElementById("password");
    const errorBox = document.getElementById("errorBox");
    const submitBtn = document.getElementById("submitBtn");
    const modeTitle = document.getElementById("modeTitle");
    const toggleText = document.getElementById("toggleText");
    const toggleModeBtn = document.getElementById("toggleModeBtn");

    let mode = "login"; // "login" or "register"

    function setMode(newMode) {
      mode = newMode;
      if (mode === "login") {
        modeTitle.textContent = "Sign in to your account";
        submitBtn.textContent = "Sign in";
        toggleText.textContent = "Don't have an account?";
        toggleModeBtn.textContent = "Create one";
      } else {
        modeTitle.textContent = "Create your account";
        submitBtn.textContent = "Create account";
        toggleText.textContent = "Already have an account?";
        toggleModeBtn.textContent = "Sign in";
      }
      errorBox.textContent = "";
    }

    toggleModeBtn.addEventListener("click", () => {
      setMode(mode === "login" ? "register" : "login");
    });

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      errorBox.textContent = "";

      const email = emailInput.value.trim();
      const password = passwordInput.value;

      if (!email || !password) {
        errorBox.textContent = "Email and password are required.";
        return;
      }

      submitBtn.disabled = true;
      submitBtn.textContent =
        mode === "login" ? "Signing in..." : "Creating account...";

      try {
        const endpoint = mode === "login" ? "/api/login" : "/api/register";

        const res = await fetch(`${API_BASE}${endpoint}`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email, password }),
        });

        const data = await res.json();

        if (!res.ok) {
          throw new Error(data.error || "Something went wrong");
        }

        if (data.token) {
          localStorage.setItem("financeflow_token", data.token);
        }
        if (data.user) {
          localStorage.setItem("financeflow_user", JSON.stringify(data.user));
        }

        window.location.href = "index.html";
      } catch (err) {
        console.error(err);
        errorBox.textContent = err.message || "Login failed.";
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent =
          mode === "login" ? "Sign in" : "Create account";
      }
    });

    const existingToken = localStorage.getItem("financeflow_token");
    if (existingToken) {
      // Optional: auto-redirect if already logged in
      // window.location.href = "index.html";
    }

    // Premium page animations
    document.addEventListener('DOMContentLoaded', function() {
      // Reveal main card
      setTimeout(() => {
        document.querySelector('.reveal').classList.add('active');
      }, 100);

      // Animate form inputs on focus
      const inputs = document.querySelectorAll('input');
      inputs.forEach(input => {
        input.addEventListener('focus', function() {
          anime({
            targets: this,
            scale: [1, 1.02, 1],
            duration: 300,
            easing: 'easeOutQuad'
          });
        });
      });

      // Button hover effect
      const submitButton = document.getElementById('submitBtn');
      submitButton.addEventListener('mouseenter', function() {
        if (!this.disabled) {
          anime({
            targets: this,
            scale: 1.02,
            duration: 200,
            easing: 'easeOutQuad'
          });
        }
      });

      submitButton.addEventListener('mouseleave', function() {
        anime({
          targets: this,
          scale: 1,
          duration: 200,
          easing: 'easeOutQuad'
        });
      });
    });
  </script>
</body>
</html>
